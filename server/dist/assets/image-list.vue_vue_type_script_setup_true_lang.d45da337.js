import{u as S,a as B}from"./bing.5482a57e.js";import{d as I,i as T,a as F,j as O,N as A,e as c,l,t as p,m as g,F as E,I as N,r as $,o as i,g as H,O as D,P as M}from"./index.1ffa4739.js";const V={key:0,class:"info-text is-refreshing"},j=["onClick"],P={key:1,class:"info-text is-loading-more"},R={key:2,class:"info-text is-no-more"},G=I({__name:"image-list",props:{showInfoText:{type:Boolean,default:!0},autoLoad:{type:[Boolean,Number],default:!0}},emits:["click-image"],setup(_,{emit:k}){const n=_,s=S(),{t:u}=B(),e=T({loadMap:{},loadCount:0}),m=F(),h=(o,a=100)=>{let r=null;return()=>{r&&clearTimeout(r),r=setTimeout(()=>{o.apply(this)},a)}},L=h(()=>{if(s.noMore)return;const o=100,a=document.body.clientHeight||document.documentElement.clientHeight,r=m.value.getBoundingClientRect();(n.autoLoad===!0||typeof n.autoLoad=="number"&&e.loadCount<n.autoLoad)&&r.bottom-o<a&&!s.loadingMore&&(h(s.loadMore)(),e.loadCount++)}),v=()=>{window.addEventListener("scroll",L,!0)};O(()=>{n.autoLoad&&v()}),A(()=>{window.removeEventListener("scroll",L,!0)});const y=(o,a)=>{e.loadMap[a]={status:!1,next:o},a===0&&o(),e.loadMap[a-1]&&e.loadMap[a-1].status===!0&&o()},C=o=>{e.loadMap[o].status=!0,M(()=>{e.loadMap[o+1]&&e.loadMap[o+1].next()})},b=o=>{e.loadMap[o].status=!1,M(()=>{e.loadMap[o+1]&&e.loadMap[o+1].next()})},w=o=>{k("click-image",o)};return(o,a)=>{const r=$("pmage");return i(),c("div",{ref_key:"imageList",ref:m,class:"image-list"},[n.showInfoText&&l(s).refreshing?(i(),c("div",V,p(l(u)("notice.refreshing")),1)):g("",!0),(i(!0),c(E,null,N(l(s).dataList,(t,f)=>(i(),c("div",{key:t==null?void 0:t.id,class:"image-item",onClick:d=>w(t)},[H(r,{placeholder:t==null?void 0:t.base64,src:t==null?void 0:t.url.thumbnail,class:"image",onBeforeLoad:d=>y(d,f),onOnload:d=>C(f),onOnerror:d=>b(f)},null,8,["placeholder","src","onBeforeLoad","onOnload","onOnerror"]),D(o.$slots,"content",{data:t})],8,j))),128)),n.showInfoText&&l(s).loadingMore?(i(),c("div",P,p(l(u)("notice.loadingMore")),1)):g("",!0),n.showInfoText&&l(s).noMore?(i(),c("div",R,p(l(u)("notice.noMore")),1)):g("",!0)],512)}}});export{G as _};
